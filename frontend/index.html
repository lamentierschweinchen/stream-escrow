<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lobster Lifeguard | Agent Income Emergency Hotline</title>
  <meta name="description" content="Missed stream renewals can quietly burn your agent's income. Call Lobster Lifeguard." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=IBM+Plex+Mono:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --night: #070b14;
      --asphalt: #151c2b;
      --danger: #ff2f32;
      --amber: #ffbb33;
      --foam: #d7f8ff;
      --neon: #55f0e3;
      --card: rgba(20, 28, 43, 0.88);
      --edge: rgba(215, 248, 255, 0.22);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      color: var(--foam);
      font-family: "IBM Plex Mono", monospace;
      background:
        radial-gradient(1200px 600px at 50% -20%, rgba(255, 47, 50, 0.3), transparent 70%),
        repeating-linear-gradient(90deg, rgba(255, 255, 255, 0.02) 0 1px, transparent 1px 42px),
        linear-gradient(180deg, #090f1b, var(--night));
      min-height: 100vh;
    }
    .page { width: min(1120px, 94vw); margin: 0 auto; padding: 22px 0 56px; }
    .billboard {
      border: 2px solid rgba(255, 187, 51, 0.5);
      border-radius: 24px;
      background: linear-gradient(140deg, rgba(255, 47, 50, 0.15), rgba(21, 28, 43, 0.95));
      padding: 22px;
      position: relative;
      box-shadow: 0 0 0 1px rgba(255, 47, 50, 0.4), 0 22px 60px rgba(0, 0, 0, 0.55);
    }
    h1, h2 { font-family: "Bebas Neue", sans-serif; letter-spacing: 0.8px; margin: 0; line-height: 1; }
    h1 { font-size: clamp(2.6rem, 9vw, 5.1rem); }
    h2 { font-size: clamp(1.7rem, 4vw, 2.5rem); color: var(--amber); }
    .headline-red { color: var(--danger); text-shadow: 0 0 12px rgba(255, 47, 50, 0.4); }
    .headline-amber { color: var(--amber); }
    .hero-grid { display: grid; grid-template-columns: 1.1fr 0.9fr; gap: 14px; margin-top: 12px; }
    .hero-copy p { margin: 10px 0; line-height: 1.55; max-width: 66ch; }
    .lobster-art {
      border: 1px solid rgba(255, 187, 51, 0.4);
      border-radius: 16px;
      background: rgba(7, 11, 20, 0.72);
      color: #ffd9ad;
      white-space: pre;
      padding: 12px;
      font-size: 0.71rem;
      overflow-x: auto;
    }
    .promo {
      display: inline-block;
      margin-top: 8px;
      border: 1px dashed rgba(255, 187, 51, 0.7);
      color: #ffe2a0;
      border-radius: 10px;
      padding: 8px 10px;
      background: rgba(255, 187, 51, 0.08);
      font-size: 0.84rem;
    }
    .tiles { margin-top: 14px; display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 10px; }
    .tile {
      background: var(--card);
      border: 1px solid var(--edge);
      border-radius: 14px;
      padding: 12px;
      min-height: 100px;
    }
    .tile b { color: var(--amber); display: block; margin-bottom: 7px; font-size: 1.02rem; }

    .section {
      margin-top: 18px;
      border: 1px solid var(--edge);
      border-radius: 16px;
      background: rgba(21, 28, 43, 0.8);
      padding: 18px;
    }
    .kpis { display: grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 10px; margin-top: 12px; }
    .kpi { border: 1px solid rgba(85, 240, 227, 0.3); border-radius: 10px; background: rgba(7, 11, 20, 0.7); padding: 10px; }
    .kpi .l { opacity: 0.8; font-size: 0.78rem; }
    .kpi .v { margin-top: 4px; color: var(--neon); font-weight: 700; word-break: break-all; }

    .cmd-card {
      margin-top: 10px;
      background: #04070f;
      border: 1px solid rgba(255, 47, 50, 0.6);
      border-radius: 14px;
      padding: 14px;
      box-shadow: 0 0 24px rgba(255, 47, 50, 0.18);
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: space-between;
    }
    .cmd {
      margin: 0;
      color: #edf9ff;
      font-size: 1.05rem;
      white-space: nowrap;
      overflow: auto;
      flex: 1;
    }
    .dollar { color: var(--danger); margin-right: 10px; font-weight: 700; }
    .btn {
      border-radius: 999px;
      padding: 10px 16px;
      border: 1px solid transparent;
      font-family: inherit;
      font-weight: 700;
      cursor: pointer;
      transition: transform 0.18s ease;
    }
    .btn.primary { background: linear-gradient(90deg, #ff2f32, #ff6d2d); color: #fff; }
    .btn.secondary { background: transparent; color: var(--foam); border-color: rgba(215,248,255,0.45); }
    .btn:hover { transform: translateY(-2px); }

    .tiny { margin-top: 8px; opacity: 0.84; font-size: 0.79rem; color: #c4eaf0; }
    .grid2 { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 10px; margin-top: 10px; }
    label { font-size: 0.82rem; opacity: 0.92; }
    input {
      width: 100%; margin-top: 5px; border-radius: 10px;
      border: 1px solid rgba(215,248,255,0.35); background: rgba(8,13,24,0.9);
      color: var(--foam); font-family: inherit; padding: 9px 10px;
    }

    footer { margin-top: 18px; text-align: center; font-size: 0.78rem; opacity: 0.72; }

    @media (max-width: 980px) {
      .hero-grid, .tiles, .kpis, .grid2 { grid-template-columns: 1fr; }
      .cmd { white-space: pre-wrap; }
      .cmd-card { flex-direction: column; align-items: flex-start; }
    }
  </style>
</head>
<body>
  <main class="page">
    <section class="billboard">
      <h1><span class="headline-red">AGENT INCOME EMERGENCY?</span><br><span class="headline-amber">CALL LOBSTER LIFEGUARD!</span></h1>
      <div class="hero-grid">
        <div class="hero-copy">
          <p>When your agent misses stream renewals, income leaks. We run the boring uptime choreography so your agent keeps stacking CLAW instead of excuses.</p>
          <div class="promo" id="promoBanner">Loading free signup count...</div>
        </div>
        <pre class="lobster-art">      .-"""-.
  _.-'  _   _  '-._
 /     (.) (.)     \
|   .-._  ^  _.-.   |  "NO MORE INCOME LEAKS"
|  /    \___/    \  |
|  \  /\     /\  /  |
 \  '-..'---'..-'  /
  '._  LIFEGUARD _.'
     '--._____.--'
</pre>
      </div>
      <div class="tiles">
        <article class="tile"><b>Humans</b>Your agent can't text you at 3:14am saying "stream dead." Keep your bots paid and your blood pressure legal.</article>
        <article class="tile"><b>Agents</b>Stop donating money to missed renewals. Stay online, stay funded, stay smug.</article>
      </div>
    </section>

    <section class="section" id="stats">
      <h2>Impact Counter</h2>
      <div class="kpis">
        <div class="kpi"><div class="l">Agents Onboarded</div><div class="v" id="kpiAgents">-</div></div>
        <div class="kpi"><div class="l">Free Signups Left</div><div class="v" id="kpiFree">-</div></div>
        <div class="kpi"><div class="l">Agents Helped Earn (CLAW)</div><div class="v" id="kpiProtected">-</div></div>
        <div class="kpi"><div class="l">Windows Covered</div><div class="v" id="kpiWindows">-</div></div>
      </div>
      <div class="tiny" id="statsMsg">Loading stats...</div>
    </section>

    <section class="section" id="signup">
      <h2>Send This To Your Agent</h2>
      <p>One short command. Your agent handles enrollment.</p>
      <div class="cmd-card">
        <p class="cmd" id="quickCmd"><span class="dollar">$</span>loremipsum-agent enroll lobster-lifeguard --auto</p>
        <button class="btn primary" id="copyQuick">Copy</button>
      </div>
      <div class="tiny">Replace this placeholder command once production contract address and agency endpoint are finalized.</div>
    </section>

    <section class="section" id="impact">
      <h2>AGENT EARNINGS</h2>
      <p>How much CLAW did this service help your specific agent earn?</p>
      <div class="grid2">
        <label>Agent address
          <input id="impactAgent" placeholder="claw1..." />
        </label>
        <label>&nbsp;
          <button class="btn secondary" id="checkImpact">Check</button>
        </label>
      </div>
      <div class="kpis">
        <div class="kpi"><div class="l">Agent Helped Earn (CLAW)</div><div class="v" id="agentProtected">-</div></div>
        <div class="kpi"><div class="l">Status</div><div class="v" id="agentImpactMsg">-</div></div>
      </div>
    </section>

    <footer>Lobster Lifeguard • Claws sovereign chain • chain=<code>C</code></footer>
  </main>

  <script>
    const $ = (id) => document.getElementById(id);
    const ATTO = 10n ** 18n;

    // Keep technical details out of the UI; set this once deployed.
    const DEFAULT_CONTRACT = "";
    const DEFAULT_API = "https://api.claws.network";

    function decodeB64ToBigInt(b64) {
      const bytes = Uint8Array.from(atob(b64), c => c.charCodeAt(0));
      let v = 0n;
      for (const b of bytes) v = (v << 8n) + BigInt(b);
      return v;
    }

    function formatClawFromAtto(value) {
      const intPart = value / ATTO;
      const frac = (value % ATTO).toString().padStart(18, "0").slice(0, 2);
      return `${intPart.toString()}.${frac}`;
    }

    async function vmQuery(contract, fn, args = []) {
      const resp = await fetch(`${DEFAULT_API}/vm-values/query`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ scAddress: contract, funcName: fn, args })
      });
      const json = await resp.json();
      const data = json?.data?.data;
      if (!data || data.returnCode !== "ok") throw new Error(data?.returnMessage || "Query failed");
      return data.returnData || [];
    }

    async function refreshStats() {
      const contract = new URLSearchParams(window.location.search).get("contract") || DEFAULT_CONTRACT;
      if (!contract) {
        $("statsMsg").textContent = "Stats will appear automatically once contract is set.";
        return;
      }
      try {
        const service = await vmQuery(contract, "getServiceStats");
        const registered = service[0] ? decodeB64ToBigInt(service[0]) : 0n;
        const promoUsed = service[2] ? decodeB64ToBigInt(service[2]) : 0n;
        const promoSlots = service[3] ? decodeB64ToBigInt(service[3]) : 0n;
        const windows = service[4] ? decodeB64ToBigInt(service[4]) : 0n;
        const protectedAtto = service[6] ? decodeB64ToBigInt(service[6]) : 0n;

        const freeLeft = promoSlots > promoUsed ? promoSlots - promoUsed : 0n;

        $("kpiAgents").textContent = registered.toString();
        $("kpiFree").textContent = freeLeft.toString();
        $("kpiWindows").textContent = windows.toString();
        $("kpiProtected").textContent = formatClawFromAtto(protectedAtto);
        $("promoBanner").textContent = `${freeLeft.toString()} free signup slots left.`;
        $("statsMsg").textContent = `We helped ${registered.toString()} agents earn about ${formatClawFromAtto(protectedAtto)} CLAW.`;
      } catch (e) {
        $("statsMsg").textContent = `Stats unavailable: ${e.message}`;
      }
    }

    async function checkAgentImpact() {
      const contract = new URLSearchParams(window.location.search).get("contract") || DEFAULT_CONTRACT;
      const agent = $("impactAgent").value.trim();
      if (!contract || !agent) {
        $("agentImpactMsg").textContent = "Need agent address (and deployed contract).";
        return;
      }
      try {
        const data = await vmQuery(contract, "getAgentServiceStats", [agent]);
        const protectedVal = data[2] ? decodeB64ToBigInt(data[2]) : 0n;
        $("agentProtected").textContent = formatClawFromAtto(protectedVal);
        $("agentImpactMsg").textContent = "Loaded";
      } catch (e) {
        $("agentImpactMsg").textContent = `Error: ${e.message}`;
      }
    }

    function copyQuick() {
      const text = $("quickCmd").innerText.replace(/^\$\s*/, "");
      navigator.clipboard.writeText(text);
    }

    $("copyQuick").addEventListener("click", copyQuick);
    $("checkImpact").addEventListener("click", checkAgentImpact);

    refreshStats();
  </script>
</body>
</html>
